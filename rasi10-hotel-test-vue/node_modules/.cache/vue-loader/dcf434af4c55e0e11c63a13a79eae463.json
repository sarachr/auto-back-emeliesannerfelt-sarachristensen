{"remainingRequest":"/home/teau/Desktop/cypress-demo-vue-project/rasi10-hotel-test-vue/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/teau/Desktop/cypress-demo-vue-project/rasi10-hotel-test-vue/src/views/Reservation.vue?vue&type=style&index=0&id=3333ec2d&lang=scss&scoped=true&","dependencies":[{"path":"/home/teau/Desktop/cypress-demo-vue-project/rasi10-hotel-test-vue/src/views/Reservation.vue","mtime":1602609006981},{"path":"/home/teau/Desktop/cypress-demo-vue-project/rasi10-hotel-test-vue/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/teau/Desktop/cypress-demo-vue-project/rasi10-hotel-test-vue/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/home/teau/Desktop/cypress-demo-vue-project/rasi10-hotel-test-vue/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/home/teau/Desktop/cypress-demo-vue-project/rasi10-hotel-test-vue/node_modules/sass-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/teau/Desktop/cypress-demo-vue-project/rasi10-hotel-test-vue/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/teau/Desktop/cypress-demo-vue-project/rasi10-hotel-test-vue/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKaDIgewoJcG9zaXRpb246IHJlbGF0aXZlOwoJYSB7CgkJcG9zaXRpb246IGFic29sdXRlOwoJCXRvcDogMDsKCQlyaWdodDogMDsKCX0KfQouYWN0aW9ucyB7CglkaXNwbGF5OiBmbGV4OwoJanVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuOwp9Cg=="},{"version":3,"sources":["Reservation.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA2KA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Reservation.vue","sourceRoot":"src/views","sourcesContent":["<script lang=\"ts\">\n\timport { Component, Vue, Watch } from 'vue-property-decorator'\n\timport { checkLoggedIn, getAll, getReservation, createReservation, editReservation, deleteReservation } from '@/services/api'\n\timport { validateDate } from '@/services/validate'\n\timport Loading from '@/components/Loading.vue'\n\timport CheckBox from '@/components/CheckBox.vue'\n\timport { Reservation } from '@/types'\n\n\t@Component({\n\t\tcomponents: { Loading, CheckBox }\n\t})\n\texport default class ReservationComponent extends Vue {\n\t\tpublic loading: boolean = false\n\t\tpublic saving: boolean = false\n\t\tpublic deleting: boolean = false\n\t\tpublic reservation: Reservation = {}\n\t\tpublic errors: string[] = []\n\t\tpublic dirty: boolean = false\n\n\t\tpublic get clients() {\n\t\t\treturn this.$store.state.clients\n\t\t}\n\n\t\tpublic get rooms() {\n\t\t\treturn this.$store.state.rooms\n\t\t}\n\n\t\tpublic get bills() {\n\t\t\treturn this.$store.state.bills\n\t\t}\n\n\n\t\tprivate async created() {\n\t\t\tif (checkLoggedIn()) {\n\n\t\t\t\tawait getAll()\n\n\t\t\t\tif (this.mode === 'create') {\n\t\t\t\t\tthis.reservation = {\n\t\t\t\t\t\tclient: '',\n\t\t\t\t\t\troom: '',\n\t\t\t\t\t\tbill: ''\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tthis.loading = true\n\t\t\t\t\tthis.reservation = await getReservation(this.$route.params.id)\n\t\t\t\t\tthis.loading = false\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tpublic get mode() {\n\t\t\treturn this.$route.params.id === 'new' ? 'create' : 'edit'\n\t\t}\n\n\t\tprivate valiate() {\n\t\t\tthis.errors = []\n\n\t\t\tif (!this.reservation.start || this.reservation.start.length === 0) {\n\t\t\t\tthis.errors.push('Start date must be set')\n\t\t\t} else if (!validateDate(this.reservation.start)) {\n\t\t\t\tthis.errors.push('Start date is not valid')\n\t\t\t}\n\n\t\t\tif (!this.reservation.end || this.reservation.end.length === 0) {\n\t\t\t\tthis.errors.push('End date must be set')\n\t\t\t} else if (!validateDate(this.reservation.end)) {\n\t\t\t\tthis.errors.push('End date is not valid')\n\t\t\t}\n\n\t\t\tif (this.reservation.client !== '' && !this.clients.find((c) => c.id === this.reservation.client)) {\n\t\t\t\tthis.errors.push('Please select a valid client')\n\t\t\t}\n\n\t\t\tif (this.reservation.room !== '' && !this.rooms.find((c) => c.id === this.reservation.room)) {\n\t\t\t\tthis.errors.push('Please select a valid room')\n\t\t\t}\n\n\t\t\tif (this.reservation.bill !== '' && !this.bills.find((c) => c.id === this.reservation.bill)) {\n\t\t\t\tthis.errors.push('Please select a valid bill')\n\t\t\t}\n\n\t\t\treturn this.errors.length === 0\n\t\t}\n\n\t\t@Watch('reservation', { deep: true })\n\t\tprivate clearErrors() {\n\t\t\tif (this.dirty) {\n\t\t\t\tthis.valiate()\n\t\t\t}\n\t\t}\n\n\t\tpublic async save() {\n\t\t\tthis.dirty = true\n\t\t\tif (!this.valiate()) {\n\t\t\t\treturn false\n\t\t\t}\n\t\t\tthis.saving = true\n\t\t\tif (this.mode === 'create') {\n\t\t\t\tthis.reservation = await createReservation(this.reservation)\n\t\t\t} else {\n\t\t\t\tthis.reservation = await editReservation(this.reservation.id, this.reservation)\n\t\t\t}\n\t\t\tthis.$router.push('/reservations')\n\t\t}\n\n\t\tpublic async remove() {\n\t\t\tthis.deleting = true\n\t\t\tawait deleteReservation(this.reservation.id)\n\t\t\tthis.$router.push('/reservations')\n\t\t}\n\n\t}\n</script>\n\n<template>\n\t<div class=\"container\">\n\t\t<h2>\n\t\t\t<div v-if=\"mode === 'create'\">New Reservation</div>\n\t\t\t<div v-if=\"mode === 'edit'\">Reservation: {{ $route.params.id }}</div>\n\t\t\t<a v-if=\"mode === 'edit'\" class=\"btn red\" @click=\"remove\">{{ deleting ? '...' : 'Delete' }}</a>\n\t\t</h2>\n\t\t<Loading v-if=\"loading\" />\n\t\t<div v-if=\"!loading\">\n\t\t\t<div class=\"field\" v-if=\"mode === 'edit'\">\n\t\t\t\t<label>ID</label>\n\t\t\t\t<input type=\"text\" disabled :value=\"reservation.id\" />\n\t\t\t</div>\n\t\t\t<div class=\"field\" v-if=\"mode === 'edit'\">\n\t\t\t\t<label>Created</label>\n\t\t\t\t<input type=\"text\" disabled :value=\"reservation.created\" />\n\t\t\t</div>\n\t\t\t<div class=\"field\">\n\t\t\t\t<label>Start <small>(Format YYYY-MM-DD)</small></label>\n\t\t\t\t<input type=\"text\" v-model=\"reservation.start\" placeholder=\"YYYY-MM-DD\" />\n\t\t\t</div>\n\t\t\t<div class=\"field\">\n\t\t\t\t<label>End <small>(Format YYYY-MM-DD)</small></label>\n\t\t\t\t<input type=\"text\" v-model=\"reservation.end\" placeholder=\"YYYY-MM-DD\" />\n\t\t\t</div>\n\t\t\t<div class=\"field\">\n\t\t\t\t<label>Client</label>\n\t\t\t\t<select v-model=\"reservation.client\">\n\t\t\t\t\t<option value=\"\">- Not selected -</option>\n\t\t\t\t\t<option v-for=\"client in clients\" :key=\"client.id\" :value=\"client.id\">{{ client.name }} (#{{ client.id }})</option>\n\t\t\t\t</select>\n\t\t\t</div>\n\t\t\t<div class=\"field\">\n\t\t\t\t<label>Room</label>\n\t\t\t\t<select v-model=\"reservation.room\">\n\t\t\t\t\t<option value=\"\">- Not selected -</option>\n\t\t\t\t\t<option v-for=\"room in rooms\" :key=\"room.id\" :value=\"room.id\">Floor {{ room.floor }}, Room {{ room.number }}</option>\n\t\t\t\t</select>\n\t\t\t</div>\n\t\t\t<div class=\"field\">\n\t\t\t\t<label>Bill</label>\n\t\t\t\t<select v-model=\"reservation.bill\">\n\t\t\t\t\t<option value=\"\">- Not selected -</option>\n\t\t\t\t\t<option v-for=\"bill in bills\" :key=\"bill.id\" :value=\"bill.id\">ID: {{ bill.id }}</option>\n\t\t\t\t</select>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class=\"error\" v-for=\"(error, i) in errors\" :key=\"i\">{{ error }}</div>\n\t\t<div class=\"actions\">\n\t\t\t<router-link class=\"btn\" to=\"/reservations\">Back</router-link>\n\t\t\t<a class=\"btn blue\" @click=\"save\">{{ saving ? '...' : 'Save' }}</a>\n\t\t</div>\n\t</div>\n</template>\n\n<style lang=\"scss\" scoped>\n\th2 {\n\t\tposition: relative;\n\t\ta {\n\t\t\tposition: absolute;\n\t\t\ttop: 0;\n\t\t\tright: 0;\n\t\t}\n\t}\n\t.actions {\n\t\tdisplay: flex;\n\t\tjustify-content: space-between;\n\t}\n</style>\n"]}]}